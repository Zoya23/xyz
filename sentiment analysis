# Code Generated by Sidekick is for learning and experimentation purposes only.
pip install pandas nltk scikit-learn
import pandas as pd
import nltk
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn.metrics import accuracy_score, precision_score, recall_score

# Download NLTK data files
nltk.download('punkt')
nltk.download('stopwords')

# Load the dataset
df = pd.read_csv('/content/TestLarge.csv')

# Data Preprocessing
def preprocess_text(text):
    # Convert to lowercase
    text = text.lower()
    # Tokenize
    tokens = word_tokenize(text)
    # Remove stop words and non-alphabetic words
    tokens = [word for word in tokens if word.isalpha() and word not in stopwords.words('english')]
    return ' '.join(tokens)

# Apply preprocessing
df['Processed_Review'] = df['Review'].apply(preprocess_text)

# Features and labels
X = df['Processed_Review']
y = df['Sentiment']

# Train-test split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Vectorization
vectorizer = CountVectorizer()
X_train_vectorized = vectorizer.fit_transform(X_train)
X_test_vectorized = vectorizer.transform(X_test)

# Model training
model = MultinomialNB()
model.fit(X_train_vectorized, y_train)

# Predictions
y_pred = model.predict(X_test_vectorized)

# Evaluation
accuracy = accuracy_score(y_test, y_pred)
precision = precision_score(y_test, y_pred, pos_label='Positive', average='binary')
recall = recall_score(y_test, y_pred, pos_label='Positive', average='binary')

print(f'Accuracy: {accuracy:.2f}')
print(f'Precision: {precision:.2f}')
print(f'Recall: {recall:.2f}')

# Sample predictions
sample_reviews = [
    "This product is amazing!",
    "I'm really disappointed with my purchase.",
    "It does exactly what I needed.",
    "Not worth the price.",
    "I would buy this again in a heartbeat!"
]

# Preprocess and vectorize sample reviews
sample_reviews_processed = [preprocess_text(review) for review in sample_reviews]
sample_reviews_vectorized = vectorizer.transform(sample_reviews_processed)

# Predict sentiment
sample_predictions = model.predict(sample_reviews_vectorized)

# Display predictions
for review, sentiment in zip(sample_reviews, sample_predictions):
    print(f'Review: "{review}" - Predicted Sentiment: {sentiment}')
